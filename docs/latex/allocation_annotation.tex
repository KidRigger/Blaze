\hypertarget{allocation_annotation_allocation_user_data}{}\section{Allocation user data}\label{allocation_annotation_allocation_user_data}
You can annotate allocations with your own information, e.\+g. for debugging purposes. To do that, fill \hyperlink{structVmaAllocationCreateInfo_a8259e85c272683434f4abb4ddddffe19}{Vma\+Allocation\+Create\+Info\+::p\+User\+Data} field when creating an allocation. It\textquotesingle{}s an opaque {\ttfamily void$\ast$} pointer. You can use it e.\+g. as a pointer, some handle, index, key, ordinal number or any other value that would associate the allocation with your custom metadata.


\begin{DoxyCode}
VkBufferCreateInfo bufferInfo = \{ VK\_STRUCTURE\_TYPE\_BUFFER\_CREATE\_INFO \};
\textcolor{comment}{// Fill bufferInfo...}

MyBufferMetadata* pMetadata = CreateBufferMetadata();

\hyperlink{structVmaAllocationCreateInfo}{VmaAllocationCreateInfo} allocCreateInfo = \{\};
allocCreateInfo.\hyperlink{structVmaAllocationCreateInfo_accb8b06b1f677d858cb9af20705fa910}{usage} = VMA\_MEMORY\_USAGE\_GPU\_ONLY;
allocCreateInfo.\hyperlink{structVmaAllocationCreateInfo_a8259e85c272683434f4abb4ddddffe19}{pUserData} = pMetadata;

VkBuffer buffer;
\hyperlink{structVmaAllocation}{VmaAllocation} allocation;
vmaCreateBuffer(allocator, &bufferInfo, &allocCreateInfo, &buffer, &allocation, \textcolor{keyword}{nullptr});
\end{DoxyCode}


The pointer may be later retrieved as \hyperlink{structVmaAllocationInfo_adc507656149c04de7ed95d0042ba2a13}{Vma\+Allocation\+Info\+::p\+User\+Data}\+:


\begin{DoxyCode}
\hyperlink{structVmaAllocationInfo}{VmaAllocationInfo} allocInfo;
vmaGetAllocationInfo(allocator, allocation, &allocInfo);
MyBufferMetadata* pMetadata = (MyBufferMetadata*)allocInfo.\hyperlink{structVmaAllocationInfo_adc507656149c04de7ed95d0042ba2a13}{pUserData};
\end{DoxyCode}


It can also be changed using function vma\+Set\+Allocation\+User\+Data().

Values of (non-\/zero) allocations\textquotesingle{} {\ttfamily p\+User\+Data} are printed in J\+S\+ON report created by vma\+Build\+Stats\+String(), in hexadecimal form.\hypertarget{allocation_annotation_allocation_names}{}\section{Allocation names}\label{allocation_annotation_allocation_names}
There is alternative mode available where {\ttfamily p\+User\+Data} pointer is used to point to a null-\/terminated string, giving a name to the allocation. To use this mode, set \#\+V\+M\+A\+\_\+\+A\+L\+L\+O\+C\+A\+T\+I\+O\+N\+\_\+\+C\+R\+E\+A\+T\+E\+\_\+\+U\+S\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+C\+O\+P\+Y\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+B\+IT flag in \hyperlink{structVmaAllocationCreateInfo_add09658ac14fe290ace25470ddd6d41b}{Vma\+Allocation\+Create\+Info\+::flags}. Then {\ttfamily p\+User\+Data} passed as \hyperlink{structVmaAllocationCreateInfo_a8259e85c272683434f4abb4ddddffe19}{Vma\+Allocation\+Create\+Info\+::p\+User\+Data} or argument to vma\+Set\+Allocation\+User\+Data() must be either null or pointer to a null-\/terminated string. The library creates internal copy of the string, so the pointer you pass doesn\textquotesingle{}t need to be valid for whole lifetime of the allocation. You can free it after the call.


\begin{DoxyCode}
VkImageCreateInfo imageInfo = \{ VK\_STRUCTURE\_TYPE\_IMAGE\_CREATE\_INFO \};
\textcolor{comment}{// Fill imageInfo...}

std::string imageName = \textcolor{stringliteral}{"Texture: "};
imageName += fileName;

\hyperlink{structVmaAllocationCreateInfo}{VmaAllocationCreateInfo} allocCreateInfo = \{\};
allocCreateInfo.\hyperlink{structVmaAllocationCreateInfo_accb8b06b1f677d858cb9af20705fa910}{usage} = VMA\_MEMORY\_USAGE\_GPU\_ONLY;
allocCreateInfo.\hyperlink{structVmaAllocationCreateInfo_add09658ac14fe290ace25470ddd6d41b}{flags} = VMA\_ALLOCATION\_CREATE\_USER\_DATA\_COPY\_STRING\_BIT;
allocCreateInfo.\hyperlink{structVmaAllocationCreateInfo_a8259e85c272683434f4abb4ddddffe19}{pUserData} = imageName.c\_str();

VkImage image;
\hyperlink{structVmaAllocation}{VmaAllocation} allocation;
vmaCreateImage(allocator, &imageInfo, &allocCreateInfo, &image, &allocation, \textcolor{keyword}{nullptr});
\end{DoxyCode}


The value of {\ttfamily p\+User\+Data} pointer of the allocation will be different than the one you passed when setting allocation\textquotesingle{}s name -\/ pointing to a buffer managed internally that holds copy of the string.


\begin{DoxyCode}
\hyperlink{structVmaAllocationInfo}{VmaAllocationInfo} allocInfo;
vmaGetAllocationInfo(allocator, allocation, &allocInfo);
\textcolor{keyword}{const} \textcolor{keywordtype}{char}* imageName = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)allocInfo.\hyperlink{structVmaAllocationInfo_adc507656149c04de7ed95d0042ba2a13}{pUserData};
printf(\textcolor{stringliteral}{"Image name: %s\(\backslash\)n"}, imageName);
\end{DoxyCode}


That string is also printed in J\+S\+ON report created by vma\+Build\+Stats\+String(). 